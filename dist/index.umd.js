/*! For license information please see index.umd.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.amisWidget=t():e.amisWidget=t()}(this,(function(){return function(){"use strict";var e={n:function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,{a:r}),r},d:function(t,r){for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r:function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{BasePlugin:function(){return o.BasePlugin},createVue3Component:function(){return O},getSchemaTpl:function(){return o.getSchemaTpl},registerAmisEditorPlugin:function(){return p},registerRendererByType:function(){return P}});var r=require("@babel/runtime/helpers/inheritsLoose"),n=e.n(r),o=require("amis-editor-core"),i=require("@babel/runtime/helpers/extends"),s=e.n(i);function a(e,t,r){void 0===r&&(r=!0);var n=function(e,t){void 0===t&&(t=!0);var r=e&&e.__super?Object.create(e.__super,{__super:{value:e.__super,writable:!1,enumerable:!1}}):Object.create(Object.prototype);return t&&e&&Object.keys(e).forEach((function(t){return r[t]=e[t]})),r}(e,r);return t&&Object.keys(t).forEach((function(e){return n[e]=t[e]})),n}var u,c,f="[amis-widget]";function p(e,t){var r=(null==t?void 0:t.rendererName)||(null==t?void 0:t.type);if(e&&e.prototype instanceof o.BasePlugin)return m(e,r),e;var i=function(e){function t(t){return e.call(this,t)||this}return n()(t,e),t}(o.BasePlugin);return Object.assign(i.prototype,new e),t&&Object.assign(i.prototype,t),m(i,r),i}function m(e,t){if(e&&function(e){var t=!1;if(!e)return!1;var r=new e;return r.rendererName?r.name?r.description?!r.tags||Array.isArray(r.tags)&&0===r.tags.length?console.error(f+"自定义插件注册失败，自定义组件分类（tags）不能为空。"):r.panelTitle?(r.icon||Object.assign(e.prototype,{icon:"fa fa-file-code-o"}),t=!0):console.error(f+"自定义插件注册失败，自定义组件配置面板Title（panelTitle）不能为空。"):console.error(f+"自定义插件注册失败，自定义组件描述（description）不能为空。"):console.error(f+"自定义插件注册失败，自定义组件名称（name）不能为空。"):console.error(f+"自定义插件注册失败，关联渲染器（rendererName）不能为空。"),t}(e)){var r=t||(new e).rendererName;Object.assign(e.prototype,{isNpmCustomWidget:!0,name:r}),window&&window.postMessage&&(n=r,o=e,window&&!window.AMISEditorCustomPlugins&&(window.AMISEditorCustomPlugins={}),(window.AMISEditorCustomPlugins[n]?(console.error(f+"注册自定义插件失败，已存在重名插件("+n+")。"),null):(window.AMISEditorCustomPlugins[n]=o,n))&&(console.info(f+"触发注册自定义插件("+r+")事件"),window.postMessage({type:"amis-widget-register-event",eventMsg:f+"注册一个自定义amis-editor插件",editorPluginName:r},"*")))}var n,o}!function(e){e.renderer="renderer",e.formitem="formitem",e.options="options"}(u||(u={})),function(e){e.react="react",e.vue2="vue2",e.vue3="vue3",e.jquery="jquery"}(c||(c={}));var d=require("@babel/runtime/helpers/assertThisInitialized"),l=e.n(d),v=require("react"),g=e.n(v);function h(e){if(e&&("function"==typeof e||"object"==typeof e))return function(t){function r(r){var n;return(n=t.call(this,r)||this).dom=void 0,n.instance=void 0,n.domRef=n.domRef.bind(l()(n)),n.instance="function"==typeof e?new e:e,n}n()(r,t);var o=r.prototype;return o.componentDidMount=function(){var e=this.instance.onMount;e&&e.apply(this.instance,[this.props])},o.componentDidUpdate=function(e){var t=this.instance.onUpdate;t&&t.apply(this.instance,[this.props,e])},o.componentWillUnmount=function(){var e=this.instance.onUnmout;e&&e.apply(this.instance,this.props)},o.domRef=function(e){this.instance.$root=this.dom=e,this._render()},o._render=function(){if(this.dom){var e=this.instance.template;"string"==typeof e?this.dom.innerHTML=e:"function"==typeof e&&(this.dom.innerHTML=e(this.props))}},o.render=function(){return g().createElement("div",{ref:this.domRef})},r}(g().Component)}require("jquery");var y=require("@babel/runtime/helpers/objectWithoutPropertiesLoose"),w=e.n(y),b=require("vue"),j=["data"];function O(e){if(e&&("function"==typeof e||"object"==typeof e))return function(t){function r(e){var r;return(r=t.call(this,e)||this).domRef=void 0,r.app=void 0,r.vm=void 0,r.isUnmount=void 0,r.domRef=g().createRef(),r.resolveAmisProps=r.resolveAmisProps.bind(l()(r)),r}n()(r,t);var o=r.prototype;return o.componentDidMount=function(){var t=this.resolveAmisProps(),r=t.amisData,n=t.amisFunc,o=e="function"==typeof e?new e:e,i=o.data,u=w()(o,j);this.app=(0,b.createApp)(s()({data:function(){return a(r,"function"==typeof i?i():i)}},u,{props:a(n,u.props||{})})),this.vm=this.app.mount(this.domRef.current)},o.componentDidUpdate=function(){var e=this;if(!this.isUnmount){var t=this.resolveAmisProps().amisData;this.vm&&Object.keys(t).forEach((function(r){e.vm[r]=t[r]}))}},o.componentWillUnmount=function(){this.isUnmount=!0,this.app.unmount()},o.resolveAmisProps=function(){var e=this,t={},r={};return Object.keys(this.props).forEach((function(n){var o,i=e.props[n];"function"==typeof i?t[n]=i:(0,b.isProxy)(i)?r[n]=(0,b.shallowRef)(i):(o=i,"Object"===Object.prototype.toString.call(o).slice(8,-1)?r[n]=(0,b.ref)(i):r[n]=i)})),{amisData:r,amisFunc:t}},o.render=function(){return g().createElement("div",{ref:this.domRef})},r}(g().Component)}function P(e,t){if(e){var r,n={type:"",usage:u.renderer,weight:0,framework:c.react};if(t&&(r=t,"String"===Object.prototype.toString.call(r).slice(8,-1))?Object.assign(n,{type:t}):Object.assign(n,t),n&&!n.type)console.error(f+"amis渲染器注册失败，渲染器类型（type）不能为空。");else{n.framework=function(e){var t=c.react;if(!e)return t;var r=e.toLowerCase().trim();switch(r){case"jquery":case"jq":r=c.jquery;break;case"vue2":case"vue 2":case"vue2.0":case"vue 2.0":r=c.vue2,console.error("vue3-amis-widget不支持vue2.0技术栈，请改用amis-widget支持。");break;case"vue":case"vue3":case"vue 3":case"vue3.0":case"vue 3.0":r=c.vue3;break;default:r=c.react}return r}(n.framework),n.usage=function(e){var t=u.renderer;if(!e)return t;var r=e.toLowerCase().trim();switch(r){case"renderer":case"renderers":default:r=u.renderer;break;case"formitem":case"form-item":case"form item":r=u.formitem;break;case"options":case"option":case"formoption":case"form-option":case"form option":r=u.options}return r}(n.usage);var o={react:function(e){return e},vue2:O,vue3:O,jquery:h}[n.framework](e);if({renderer:function(){},formitem:function(){},options:function(){}}[n.usage]){if(window&&window.postMessage){var i=(s=n.type,a={type:n.type,weight:n.weight,usage:n.usage,framework:n.framework,component:o},window&&!window.AmisCustomRenderers&&(window.AmisCustomRenderers={}),window.AmisCustomRenderers[s]?(console.error(f+"注册amis渲染器失败，已存在重名渲染器("+s+")。"),null):(window.AmisCustomRenderers[s]=a,s));i&&(console.info(f+"触发注册amis渲染器("+i+")事件"),window.postMessage({type:"amis-renderer-register-event",eventMsg:f+"注册一个自定义amis渲染器",amisRenderer:{type:i,weight:n.weight,usage:n.usage}},"*"))}}else console.error(f+"amis渲染器注册失败，暂不支持"+n.usage+"组件类型。")}}var s,a}return t}()}));